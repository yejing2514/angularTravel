<!DOCTYPE html>
<html lang="en" ng-app="health">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Carousel Template for Bootstrap</title>

    <!-- Bootstrap core CSS -->
    <link href="./css/bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="http://cdn.bootcss.com/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

  </head>
<!-- NAVBAR
================================================== -->
  <body>

    <ui-view></ui-view>

    <script src="http://cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>
    <script src="./js/bootstrap.min.js"></script>
    <script type="text/javascript" src="./js/angular.js"></script>
    <script type="text/javascript" src="./js/angular-ui-router.js"></script>
    <script type="text/javascript">

      var healthApp =angular.module('health',['ui.router'])
      .config(function($stateProvider,$urlRouterProvider,$urlMatcherFactoryProvider){
        $urlRouterProvider.otherwise('/navbar/home');
        $urlMatcherFactoryProvider.caseInsensitive(true);
        $stateProvider
        .state('navbar',{
          url:'/navbar',
          templateUrl:'./template/navbar.html',
          controller:'navbarController'
        })
        .state('navbar.home',{
          url:'/home',
          templateUrl:'./template/home.html',
          controller:'homeController'
        })
        .state('navbar.drugList',{
          url:'/drugList/:id/:page',
          templateUrl:'./template/drugList.html',
          controller:'drugListController'
        })
        .state('navbar.drugDetail',{
          url:'/drugDetail/:id',
          templateUrl:'./template/drugDetail.html',
          controller:'drugDetailController'
        })
      })
      .controller('navbarController',function($scope,$http){
        $http({
          url:'http://localhost/drug-categories.php'
        }).then(function(res){
          $scope.drugcategories = res.data.tngou;
        })
      })
      .controller('homeController',function($scope){
        $scope.welcome = "欢迎";
      })
      .controller('drugListController',function($scope,$stateParams,$http){
        $http({
          url:'http://localhost/drug-list.php',
          params:{
            id:$stateParams.id,
            page:$stateParams.page
          }
        }).then(function(res){
          $scope.drugList = res.data.tngou;
          
          var pageCountList = [];
          var rows = 9;

          for(var i=1;i<=10; i++){
            pageCountList.push(i);
          }
          $scope.id = $stateParams.id;
          $scope.pageLCountist = pageCountList;
        })
      })
      .controller('drugDetailController',function($scope,$stateParams,$http){
        $http({
          url:'http://localhost/drug-detail.php',
          params:{
            id:$stateParams.id
          }
        }).then(function(res){
          $scope.detail = res.data.tngou;
          console.log(res.data)
        })
      })
    </script>

  </body>
</html>