
<!DOCTYPE html>
<html lang="en" ng-app="travel">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Carousel Template for Bootstrap</title>

    <!-- Bootstrap core CSS -->
    <link href="./css/bootstrap.min.css" rel="stylesheet">
		<link rel="stylesheet" type="text/css" href="./css/index.css"/>
    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="http://cdn.bootcss.com/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Custom styles for this template -->
  </head>
<!-- NAVBAR
================================================== -->
  <body>
  	
	  <ui-view></ui-view>


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="http://cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>
    <script src="./js/bootstrap.min.js"></script>
    <script type="text/javascript" src="./js/angular.js" ></script>
    <script type="text/javascript" src="./js/angular-ui-router.js"></script>
    <script>
    	
    	var travelApp =angular.module('travel',['ui.router'])
    	.config(function($stateProvider,$urlRouterProvider,$urlMatcherFactoryProvider){
    		$urlRouterProvider.otherwise('/navbar');
    		$urlMatcherFactoryProvider.caseInsensitive(true);
    		$stateProvider
    		.state('navbar',{
    			url:'/navbar',
    			templateUrl:'./template/navbar.html',
    			controller:'navbarController'
    		})
    	
    		.state('navbar.weather',{
    			url:'/weather/:cityname',
    			templateUrl:'./template/weather.html',
    			controller:'weatherController'
    		})	/*查询天气模块:cityname传入指定的城市参数*/
    		
    	})
    	.controller('navbarController',function($scope,$stateParams,$http){
    	
    	})
    	
    	.controller('weatherController',function($scope,$http,$stateParams){
    		$http({
    			url:'http://localhost/weather.php/',
    			params:{
    				cityname:$stateParams.cityname,
    				
    			}
    			/*params代表发送给php名为cityname的参数参数即是*weather/:cityname',*里面的cityname*/
    		}).then(function(res){
    			$scope.searchWeather=function(city){
    			
    						window.location='http://localhost:8000/#/navbar/weather/'+city
    			
    				/*这是搜索按钮的点击事件目标是将传入的参数接受然后请求不同城市的天气*/
    			}
						console.log($stateParams)
    			
    				console.log(res)
    			$scope.cityWeather=res.data.retData
    			$scope.cityname = $stateParams.city;
    
			/*$scope.cityWeather=res.data.retData 设置了一个变量cityWeather接受ajax请求过来的数据*/
			/*	$scope.cityname = $stateParams.city; 设置了一个表里cityname*即为传下来对象URL的参数*/
    		})
    	})
    </script>
  </body>
</html>
